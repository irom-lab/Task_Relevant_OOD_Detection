# Task-Driven Out-of-Distribution Detection for Robot Learning
This repository contains code for the out-of-distribution (OOD) detection approach presented in the paper titled: Task-Driven Detection of Distribution Shifts with Statistical Guarantees for Robot Learning. 

**Description:** Our goal is to performout-of-distribution  (OOD)  detection, i.e., to detect when a robot isoperating in environments that are drawn from a different distribution than the environmentsused to train the robot.  We leverage Probably Approximately Correct (PAC)-Bayes theory inorder to train a policy with aguaranteed boundon performance on the training distribution. Ourkey idea for OOD detection then relies on the following intuition:  violation of the performancebound on test environments provides evidence that the robot is operating OOD. We formalizethis via statistical techniques based on p-values and concentration inequalities.  The resultingapproach (i) provides guaranteed confidence bounds on OOD detection including bounds on boththe false positive and false negative rates of the detector and (ii) istask-drivenand sensitiveonly to changes that impact the robotâ€™s performance.  We demonstrate our approach in bothsimulation and hardware for a grasping task using objects with unfamiliar shapes or poses anda drone performing vision-based obstacle avoidance in unfamiliar environments (including winddisturbances and different obstacle densities).  Our examples demonstrate that we can performtask-driven  OOD  detection  within  just  a  handful  of  trials.   Comparisons  with  baselines  alsodemonstrate  the  advantages  of  our  approach  in  terms  of  providing  statistical  guarantees  andbeing insensitive to task-irrelevant distribution shifts.

The code for computing the p-values and the confidence intervals is available in this file: [ood_detect.py](./ood_detect.py).

This approach is applied on the tasks of robotic grasping and navigation of a drone through obstacle fields. Code for these robotic tasks and instructions to run it is available in the following folders:
1. [Grasp](./grasp)
2. [Navigate](./navigate)
